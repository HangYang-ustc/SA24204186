---
title: "hw5"
author: "阳航"
date: "2024-12-08"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to R-package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
7.8 题 - Jackknife 偏差和标准误估计：
```{r}
# 假设有一个主成分分析的例子
eigen_values <- c(3.5, 2.1, 1.5, 1.2, 0.8)
theta_hat <- eigen_values[1] / sum(eigen_values)

# Jackknife估计偏差和标准误差
jackknife_values <- sapply(1:length(eigen_values), function(i) {
  theta_i <- eigen_values[-i][1] / sum(eigen_values[-i])
  return(theta_i)
})
bias <- (length(eigen_values) - 1) * (mean(jackknife_values) - theta_hat)
se <- sqrt((length(eigen_values) - 1) * mean((jackknife_values - mean(jackknife_values))^2))

list(bias = bias, se = se)

```
7.10 题 - 交叉验证和调整R²值：
```{r}
# 示例数据
set.seed(123)
x <- rnorm(100)
y <- 2*x^3 + rnorm(100)

# 使用cubic多项式拟合
model_cubic <- lm(y ~ poly(x, 3))

# 使用leave-one-out交叉验证
library(boot)
cv_error <- cv.glm(data = data.frame(x, y), glmfit = model_cubic, K = length(x))

# 调整R²值
adj_r2 <- summary(model_cubic)$adj.r.squared

list(cv_error = cv_error$delta[1], adj_r2 = adj_r2)

```
8.1 题 - 置换检验：
```{r}
# 假设有两个样本F和G
F <- rnorm(30, mean = 0)
G <- rnorm(30, mean = 0.5)

# 计算原始统计量
original_stat <- mean(F) - mean(G)

# 置换检验
pooled <- c(F, G)
perm_stats <- replicate(1000, {
  permuted <- sample(pooled)
  F_perm <- permuted[1:30]
  G_perm <- permuted[31:60]
  return(mean(F_perm) - mean(G_perm))
})

p_value <- mean(abs(perm_stats) >= abs(original_stat))
p_value

```
8.2 题 - 多样本置换检验：
```{r}
# 假设有三个样本A, B, C
A <- rnorm(30, mean = 1)
B <- rnorm(30, mean = 0.5)
C <- rnorm(30, mean = 0)

# 计算原始统计量，总体均值差异
original_stat <- var(c(A, B, C))

# 置换检验
pooled <- c(A, B, C)
perm_stats <- replicate(1000, {
  permuted <- sample(pooled)
  A_perm <- permuted[1:30]
  B_perm <- permuted[31:60]
  C_perm <- permuted[61:90]
  return(var(c(A_perm, B_perm, C_perm)))
})

p_value <- mean(perm_stats >= original_stat)
p_value

```
